
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/> 
<link rel="icon" href="favicon.ico" type="image/x-icon"/> 
<!-- <link rel="stylesheet" href="assets/css/jquery.mobile-1.5.0-alpha.1.min.css"> -->
<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
<!-- <script src="assets/js/jquery-3.2.1.min.js"></script>  -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js"> </script>
<!-- <script src="assets/js/jquery.mobile-1.5.0-alpha.1.min.js"></script> -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<style type="text/css">
    body{
        background-color: #fff;
    }
    .ui-loader{
        display: none;
    }
</style>
</head>
<body>



<div class="container" style="margin-top: 10px;">
    <div class="row">
        <div class="col-xs-6"> 
            <div class="row text-left">
                <select id="surat" style="text-align: center; text-align-last: center; width: 99%; border-radius: 4px; border: 1px solid #000; font-size: 16pt; direction: ltr!important; height: 40px;"></select>
            </div>
        </div> 
        <div class="col-xs-6"> 
            <div class="row text-right">
                <select id="font_size" style="text-align: center; text-align-last: center; width: 99%; border-radius: 4px; border: 1px solid #000; font-size: 16pt; direction: ltr!important; height: 40px;"> 
                    <optgroup label="-- Perbesar --">
                        <option value="30">30 pt</option>
                        <option value="40">40 pt</option>
                        <option value="50">50 pt</option>
                        <option value="60">60 pt</option>
                    </optgroup>
                    <optgroup label="-- Perkecil --">
                        <option value="26">26 pt</option>
                        <option value="24">24 pt</option>
                        <option value="20">20 pt</option>
                        <option value="14">14 pt</option>
                        <option value="10">10 pt</option>
                    </optgroup>
                </select>
            </div>
        </div>
    </div>
    <!-- <div id="judul" class="h1 text-center"></div> -->
    
    <div id="content" style="margin-top: 40px;"></div>
</div>

<div class="clearfix row" id="nav" style="text-align: center;direction: rtl; margin: 50px auto;">
    <div class="col-xs-4">
        <div class="row" style="padding: 0 10px;">
            <button class="btn btn-success btn-lg btn-block next" style="width: ;height:100px;">&gt;</button>
        </div>
    </div>
    <div class="col-xs-4">
        <div class="row text-center">
            <select id="ayat" style="text-align: center; text-align-last: center; width:100%;height: 100px; border-radius: 4px; border: 1px solid #000; font-size: 16pt; direction: ltr!important; "></select>
        </div>
    </div>
    <div class="col-xs-4">
        <div class="row" style="padding: 0 10px;">
            <button class="btn btn-success btn-lg btn-block prev" style="width: ;height:100px;">&lt;</button>
        </div>
    </div>
</div>
    <hr/>
<div class="footer text-center" style="margin:50px 0;">&copy; 2019 - Jerry Maheswara</div>
<div class="footer text-center" style="margin-bottom:50px;">
    <div><a href="index.html" class="btn">Per Page</a></div>
    <div><a href="api-doc.html" class="btn">API Documentation</a></div>
</div>
<script>
    var jml_ayat=[7,286,200,176,120,165,206,75,129,109,123,111,43,52,99,128,111,110,98,135,112,78,118,64,77,227,93,88,69,60,34,30,73,54,45,83,182,88,75,85,54,53,89,59,37,35,38,29,18,45,60,49,62,55,78,96,29,22,24,13,14,11,11,18,12,12,30,52,52,44,28,28,20,56,40,31,50,40,46,42,29,19,36,25,22,17,19,26,30,20,15,21,11,8,8,19,5,8,8,11,11,8,3,9,5,4,7,3,6,3,5,4,5,6];

    var nama_surat=["Al-Faatihah","Al-Baqarah","Ali 'Imran","An-Nisaa'","Al-Maa`idah","Al-An'am","Al-A'raaf","Al-Anfaal","At-Taubah","Yunus","Huud","Yusuf","Ar-Ra'd","Ibrahim","Al-Hijr","An-Nahl","Al-Israa'","Al-Kahfi","Maryam","Thaahaa","Al-Anbiyaa'","Al-Hajj","Al-Mu'minuun","An-Nuur","Al-Furqaan","Asy-Syu'araa'","An-Naml","Al-Qashash","Al-'Ankabuut","Ar-Ruum","Luqman","As-Sajdah","Al-Ahzab","Saba'","Faathir","Yaasiin","Ash-Shaaffat","Shaad","Az-Zumar","Al-Mu'min","Fushshilat","Asy-Syuura","Az-Zukhruf","Ad-Dukhaan","Al-Jaatsiyah","Al-Ahqaaf","Muhammad","Al-Fath","Al-Hujuraat","Qaaf","Adz-Dzariyaat","Ath-Thuur","An-Najm","Al-Qamar","Ar-Rahmaan","Al-Waaqi'ah","Al-Hadiid","Al-Mujaadilah","Al-Hasyr","Al-Mumtahanah","Ash-Shaff","Al-Jumu'ah","Al-Munaafiquun","At-Taghaabun","Ath-Thalaaq","At-Tahriim","Al-Mulk","Al-Qalam","Al-Haaqqah","Al-Ma'aarij","Nuh","Al-Jin","Al-Muzzammil","Al-Muddatstsir","Al-Qiyaamah","Al-Insaan","Al-Mursalaat","An-Naba'","An-Nazi'at","'Abasa","At-Takwiir","Al-Infithaar","Al-Muthaffifiin","Al-Insyiqaaq","Al-Buruuj","Ath-Thaariq","Al-A'laa","Al-Ghaasyiyah","Al-Fajr","Al-Balad","Asy-Syams","Al-Lail","Adh-Dhuhaa","Alam Nasyrah","At-Tiin","Al-'Alaq","Al-Qadr","Al-Bayyinah","Al-Zalzalah","Al-'Aadiyaat","Al-Qaari'ah","At-Takaatsur","Al-'Ashr","Al-Humazah","Al-Fiil","Quraisy","Al-Maa'uun","Al-Kautsar","Al-Kaafiruun","An-Nashr","Al-Lahab","Al-Ikhlash","Al-Falaq","An-Naas"];
 
    function load(param) { 
        $.ajax({
            url: 'per-ayah.php',
            type:'GET',
            data:{
                'surah' : param.surah,
                'ayah' : param.ayah,
                'font_size' : param.font_size,
                'format': 'html'
            }
        })
        .done(function(res) { 
            $('#content').html(res)
        })
        .fail(function(err) {
            console.log(err.responeText);
        });     
    }
    function init() {
        var surah_active = localStorage.getItem("surah_active");
        var ayah_active = localStorage.getItem("ayah_active"); 
        if (surah_active == null) {
            $('#surat').trigger('change');
        }else{ 
            var param = {};
            var ayah_total = localStorage.getItem("ayah_total");
            var font_size = localStorage.getItem("font_size");
            param.surah = surah_active;
            param.ayah = ayah_active;
            param.font_size = font_size;
            load(param);
            $('#ayat').html('');
            for (var j = 1; j < jml_ayat[surah_active-1]+1; j++) { 
                $('#ayat').append('<option value="'+j+'">'+j+'</option>');
            }
            $('#surat').find('option').removeAttr('selected');
            $('#surat option[value="'+param.surah+'"]').attr('selected', true);
            $('#judul').html($('#surat option[value="'+param.surah+'"]').text());
            $('#ayat').val(ayah_active) ;
            $('#font_size').val(font_size) ;
            // $('#ayat').find('option').removeAttr('selected');
            // $('#ayat option[value="'+param.ayah+'"]').attr('selected', true);
            // $('#ayat').siblings('.ui-selectmenu-button-text').html(param.ayah);
            rebutton();

        } 
    }

    // $('html').on('swiperight', function(e){
    //     alert('swiperight');
    // });
    // $('html').on('swipeleft', function(e){
    //     alert('swipeleft');
    // });


    function rebutton() {
        var ayah_active = parseInt(localStorage.getItem("ayah_active")) ;
        var ayah_total = parseInt(localStorage.getItem("ayah_total")) ;
        var font_size = parseInt(localStorage.getItem("font_size")) ;
        if (ayah_active > 0 && ayah_active <= ayah_total) {
            $('.prev').attr('data-val',parseInt(ayah_active)-1);
            $('.next').attr('data-val',parseInt(ayah_active)+1);
            if (ayah_active == ayah_total) {
                $('.next').attr('data-val',parseInt(ayah_total));
            }
        } 
        $('#font_size').val(font_size);

        $("html, body").animate({ scrollTop: 0 }, "fast");
        return false;
    }
    // rebutton();
    $('button').each(function(index, el) {
        $(this).on('click', function(event) {
            event.preventDefault(); 
            var ayah_target = parseInt($(this).attr('data-val'));
            var ayah_total = parseInt(localStorage.getItem("ayah_total")) ;
            if (ayah_target > 0 && ayah_target <= ayah_total) {
                localStorage.setItem("ayah_active", ayah_target);
                $('#ayat').val(ayah_target).trigger('change');
            }
        });
    });
    $(document).ready(function(){
        var param = {}; 
        for (var i = 1 ; i <=114; i++) {
            $('#surat').append('<option value="'+i+'">'+i+'. '+nama_surat[i-1]+ ' - '+ jml_ayat[i-1]+' ayat </option>');
        }
        $('#surat').on('change', function(event) {
            event.preventDefault(); 
            var idx_surah = $(this).val() - 1;
            localStorage.setItem("surah_active", $(this).val()); 
            localStorage.setItem("ayah_total", jml_ayat[idx_surah]); 
            localStorage.setItem("ayah_active", 1); 
            localStorage.setItem("font_size", $('#font_size').val()); 

            param.surah = $(this).val();
            param.ayah = 1;
            param.font_size = $('#font_size').val(); 
            load(param);
            $('#ayat').html('');
            for (var j = 1; j < jml_ayat[idx_surah]+1; j++) { 
                $('#ayat').append('<option value="'+j+'">'+j+'</option>');
            }
            $(this).find('option').removeAttr('selected');
            $('#surat option[value="'+param.surah+'"]').attr('selected', true);
            $('#judul').html($('#surat option[value="'+param.surah+'"]').text());
            $('#ayat').val(param.ayah);
            rebutton();

        });

        $('#ayat').on('change', function(event) {
            event.preventDefault(); 
            var ay = $(this).val();
            var param = {};
            param.surah = $('#surat').val();
            param.ayah = ay;
            param.font_size = $('#font_size').val();
            load(param);
            localStorage.setItem("ayah_active", ay); 
            $(this).find('option').removeAttr('selected');
            $('#ayat option[value="'+ay+'"]').attr('selected', true);
            rebutton();
        });
        $('#font_size').on('change', function(event) {
            event.preventDefault();
            localStorage.setItem("font_size", $(this).val()); 
            var param = {};
            param.surah = $('#surat').val();
            param.ayah = $('#ayat').val();
            param.font_size = $(this).val();
            load(param);
        });
        init();
    });
</script>

<!--
</body>
</html>